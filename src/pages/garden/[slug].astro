---
export async function getStaticPaths() {
    // 1. 使用 Vite 的 glob 功能直接抓取文件
    // 修正路径：从 src/pages/garden 到 src/content/garden 只需要两层回退
    const posts = Object.values(import.meta.glob('../../content/garden/*.md', { eager: true }));
    
    return posts.map((post: any) => {
        // 如果没有 slug，就尝试用文件名
        const slug = post.frontmatter.slug || post.file.split('/').pop()?.replace('.md', '');
        return {
            params: { slug },
            props: { post },
        };
    });
}

const { post } = Astro.props;
// 在 glob 模式下，Content 是这一堆复杂的属性之一
const Content = post.Content;
---

---
<!doctype html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8" />
		<title>{post.frontmatter.title} - Antigravity Garden</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown-light.min.css">
        <style>
            body {
                background-color: #f8f9fa;
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                margin: 0;
                padding: 0;
            }
            .container {
                max-width: 760px;
                margin: 0 auto;
                padding: 2rem 1rem;
            }
            nav {
                margin-bottom: 2rem;
            }
            a.back-link {
                color: #6c757d;
                text-decoration: none;
                font-weight: 500;
                font-size: 0.95rem;
                display: inline-flex;
                align-items: center;
            }
            a.back-link:hover {
                color: #10b981;
            }
            
            article {
                background: #fff;
                padding: 40px;
                border-radius: 12px;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            }
            
            header {
                text-align: center;
                margin-bottom: 3rem;
                border-bottom: 1px solid #eee;
                padding-bottom: 2rem;
            }
            h1 {
                margin: 0 0 0.5rem 0;
                font-size: 2rem;
            }
            time {
                color: #9ca3af;
            }

            /* 修正 markdown-body 的一些边距 */
            .markdown-body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            }
        </style>
	</head>
	<body>
        <div class="container">
            <nav>
                <a href="/" class="back-link">← 返回花园</a>
            </nav>

            <article>
                <header>
                    <h1>{post.frontmatter.title}</h1>
                    <time>{new Date(post.frontmatter.date).toLocaleDateString('zh-CN')}</time>
                </header>
                
                <div class="markdown-body">
                    <Content />
                </div>
            </article>
        </div>
	</body>
</html>
